<!doctype html>
<html lang="es">
    {% block content_header %}
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <title>Logs Mensajes</title>
        <meta name="author" content="Raziel Valle Miranda">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="HandheldFriendly" content="true">
        <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
        {% stylesheets 'bundles/fractaliasms/css/*' filter='cssrewrite' %}
        <link rel="stylesheet" href="{{ asset( asset_url) }}"/>
        {% endstylesheets %}

        {% javascripts
            '@FractaliaSmsBundle/Resources/public/js/jquery-1.11.0.min.js'
            '@FractaliaSmsBundle/Resources/public/js/retina.js'
            '@FractaliaSmsBundle/Resources/public/js/main.js'
            output='js/compiled/javascripts.js'
        %}
        <script type="text/javascript" src="{{ asset( asset_url) }}"></script>
        {% endjavascripts %}
        <!--[if lt IE 9]>
          <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
          <script src="http://css3-mediaqueries-js.googlecode.com/svn/trunk/css3-mediaqueries.js"></script>
        <![endif]-->
        <link rel="shortcut icon" type="image/x-icon" href="{{ asset('favicon.ico') }}" />
        <link rel="icon" type="image/x-icon" href="{{ asset('favicon.ico') }}" />
    {%endblock%}

    {% block body -%}
        <div id="view">
            <header>
                <h1>Log Mensajes</h1>
                <div id='cssmenu'>
                    <ul>
                        <li><a href='#'><span>Configuraciones</span></a></li>
                        <li><a href='#'><span>Tsol</span></a>
                            <ul>
                                <li><a href='#'>Ver/modificar</a></li>
{#                                <li><a href='#'>Menus</a></li>
                                <li><a href='#'>Products</a></li>#}
                            </ul>
                        </li>
                        <li><a href='#'><span>Nombres Cortos</span></a>
                            <ul>
                                <li><a href='#'>Gestionar</a></li>
{#                                <li><a href='#'>Location</a></li>#}
                            </ul>
                        </li>
{#                        <li><a href='#'><span>Contact</span></a></li>#}
                    </ul>
                </div>
            </header>

            <div id="container">
                <ul>
                    {%set namepic = "" %}
                    {% for entity in entities %}
                        {%if entity.estadoenvio == 'ERROR_BUILD' or entity.estadoenvio == 'ERROR' %}
                            <a href="{{ path('mensajes_edit', { 'id': entity.id }) }}">
                            {%elseif entity.estadoenvio == 'ENVIADO' or entity.estadoenvio == 'POR_ENVIAR' %}
                                <a href="{{ path('mensajes_show', { 'id': entity.id }) }}">
                                {%endif%}
                                <li class="clearfix">
                                    {% set namepic = entity.destinatario | lower %}
                                    {% image '@FractaliaSmsBundle/Resources/public/images/icon-default.png' %}
                                    <img src="{{ asset_url }}" alt="thumb" class="thumbnail"/>
                                    {% endimage %}
                                    <h2>
                                        {%if entity.estadoenvio == 'ERROR_BUILD' %}
                                            ERROR EN EL MENSAJE  (grupo envio: {{ entity.destinatario }})
                                        {%elseif entity.estadoenvio == 'ERROR' %}
                                            ERROR EN LOS DATOS   (grupo envio: {{ entity.destinatario }})                              
                                        {%elseif entity.estadoenvio == 'ENVIADO' %}
                                            {{ entity.estadoenvio }} al grupo: {{ entity.destinatario }}
                                        {%elseif entity.estadoenvio == 'POR_ENVIAR' %}
                                            MENSAJE POR ENVIAR al grupo: {{ entity.destinatario }}
                                        {%endif%}
                                    </h2>
                                    <p class="desc">{{entity.mensaje.tipomensaje}} {{entity.mensaje.texto|slice(0, 23)}}...</p>
                                    <span class="price">
                                        {% if entity.fechaEnvio %}
                                            Enviado: {{ entity.fechaEnvio|date('d/m/y H:i:s') }}
                                        {% elseif entity.fechaCreacion %}
                                            Creado: {{ entity.fechaCreacion|date('d/m/y H:i:s') }}
                                        {% endif %}
                                    </span>
                                </li></a>

                        {% endfor %}
                </ul>
            </div>
        </div>
        <script>

            $(document).ready(function() {
                $('#load_tso').click(function(event) {
                    event.preventDefault(); //cancela el comportamiento por defecto
                    $('#tsol-data').load('{{ path('tsol') }}');
                });
            });

        </script>
    {% endblock %}
